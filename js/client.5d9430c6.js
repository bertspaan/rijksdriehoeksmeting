(function(t){function e(e){for(var a,o,r=e[0],c=e[1],d=e[2],u=0,h=[];u<r.length;u++)o=r[u],i[o]&&h.push(i[o][0]),i[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(h.length)h.shift()();return s.push.apply(s,d||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,r=1;r<n.length;r++){var c=n[r];0!==i[c]&&(a=!1)}a&&(s.splice(e--,1),t=o(o.s=n[0]))}return t}var a={},i={client:0},s=[];function o(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=a,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(n,a,function(e){return t[e]}.bind(null,a));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var d=0;d<r.length;d++)e(r[d]);var l=c;s.push([1,"chunk-vendors"]),n()})({1:function(t,e,n){t.exports=n("7ed9")},"3a5e":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"message"},[n("p",{staticClass:"dutch"},[t._v("Laden…")]),n("p",{staticClass:"english"},[t._v("Loading…")])])])}],s={name:"loading"},o=s,r=(n("fa23"),n("2877")),c=Object(r["a"])(o,a,i,!1,null,"58e84d70",null);e["a"]=c.exports},"77cf":function(t,e,n){"use strict";var a=n("a246"),i=n.n(a);i.a},"7ed9":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[t._m(0),n("main",[t.locations?[n("Map",{attrs:{locations:t.locations},on:{update:t.updateImages}})]:[n("Loading")]],2),n("footer",{class:{active:t.active,inactive:!t.active}},[t.active?n("div",[t.ids.length?[n("span",{staticClass:"dutch"},[t._v("\n          De geselecteerde foto’s worden getoond op het scherm.\n        ")]),n("span",{staticClass:"english"},[t._v("\n          The selected photos are displayed on the screen.\n        ")])]:[n("span",{staticClass:"dutch"},[t._v("\n          Geen meetpunten gevonden in de buurt van deze locatie.\n        ")]),n("span",{staticClass:"english"},[t._v("\n          No measuring points found around this location.\n        ")])]],2):n("div",[n("span",{staticClass:"dutch"},[t._v("\n        Een moment geduld a.u.b.: het scherm wordt door iemand anders bediend.\n      ")]),n("span",{staticClass:"english"},[t._v("\n        One moment, please: someone else is operating the screen.\n      ")])])])])},s=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",[n("span",{staticClass:"dutch"},[t._v("\n      Beweeg de kaart om foto’s op het scherm te tonen.\n    ")]),n("span",{staticClass:"english"},[t._v("\n      Move the map to display photos on the screen.\n    ")])])}],o=n("bc3a"),r=n.n(o),c=n("a0be"),d=n("3a5e"),l=n("abd2"),u={name:"client",mixins:[l["a"]],components:{Map:c["a"],Loading:d["a"]},data:function(){return{active:!0,timeout:void 0,ids:[],locations:void 0,ttl:2e4}},watch:{active:function(){var t=this;this.timeout&&window.clearTimeout(this.timeout),this.timeout=window.setTimeout(function(){t.active=!0},this.ttl)}},methods:{updateImages:function(t){this.ids=t,this.wsSend("client",this.ids)}},created:function(){var t=this;this.$on("ws:message",function(e){t.active=e.active})},mounted:function(){var t=this;r.a.get("../locations.display.geojson").then(function(e){return t.locations=e.data,t.locations})}},h=u,p=(n("77cf"),n("2877")),f=Object(p["a"])(h,i,s,!1,null,null,null),m=f.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(m)}}).$mount("#app")},a0be:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"component"},[n("div",{staticClass:"map-container"},[n("div",{ref:"map",staticClass:"map"})]),n("div",{staticClass:"rectangle-container",style:{padding:t.rectanglePadding+"px"}},[n("div",{staticClass:"rectangle"})])])},i=[],s=(n("ac6a"),n("768b")),o=n("2ef0"),r=n("7977"),c=n("8493"),d={props:{locations:Object},data:function(){return{highlightedIds:[],index:void 0,rectanglePadding:30}},methods:{throttledSendData:Object(o["throttle"])(function(){this.sendData()},500),sendData:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.map&&this.index&&this.$refs.map){var n=8,a=this.map.getCenter(),i=this.$refs.map.getBoundingClientRect(),o=this.map.unproject([this.rectanglePadding,this.rectanglePadding]),r=this.map.unproject([i.width-this.rectanglePadding,i.height-this.rectanglePadding]),d=c.around(this.index,a.lng,a.lat,n,void 0,function(t){var e=Object(s["a"])(t.geometry.coordinates,2),n=e[0],a=e[1],i=a<=o.lat&&a>=r.lat,c=n>=o.lng&&n<=r.lng;return i&&c});this.highlightedIds.forEach(function(e){t.map.setFeatureState({id:e,source:"points"},{highlight:!1})}),this.highlightedIds=d.map(function(t){return t.id}),this.highlightedIds.forEach(function(e){t.map.setFeatureState({id:e,source:"points"},{highlight:!0})}),this.$emit("update",this.highlightedIds,e)}}},mounted:function(){var t=this;this.index=new r["a"](this.locations.features,function(t){return t.geometry.coordinates[0]},function(t){return t.geometry.coordinates[1]});var e=new mapboxgl.Map({container:this.$refs.map,style:{version:8,sources:{basemap:{type:"raster",tiles:["https://a.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png","https://b.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png","https://c.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png","https://d.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"basemap",type:"raster",source:"basemap",minzoom:7,maxzoom:17}]},minZoom:7,maxZoom:16.5,maxBounds:[[1.5,49.8],[8.5,55]],center:[4.922,52.369],zoom:9,hash:!0,pitchWithRotate:!1,dragRotate:!1});e.on("load",function(){e.addSource("points",{type:"geojson",data:t.locations}),e.addLayer({id:"points",type:"circle",source:"points",paint:{"circle-radius":["interpolate",["linear"],["zoom"],8,4,16,10],"circle-opacity":["case",["boolean",["feature-state","highlight"],!1],1,.4],"circle-color":["case",["boolean",["feature-state","highlight"],!1],"#ed1c24","#ede321"]}}),t.sendData(!1)}),e.on("move",function(){t.throttledSendData()}),this.map=e}},l=d,u=(n("e351"),n("2877")),h=Object(u["a"])(l,a,i,!1,null,"a4d46680",null);e["a"]=h.exports},a246:function(t,e,n){},abd2:function(t,e,n){"use strict";var a=n("4d7f");e["a"]={name:"WebSocket",data:function(){return{rws:new a["a"]("wss://rijksdriehoeksmeting-api.glitch.me/ws")}},props:{url:{type:String}},methods:{wsSend:function(t,e){var n={type:t,timestamp:+new Date,data:e};this.rws.send(JSON.stringify(n))}},created:function(){var t=this;this.rws.addEventListener("open",function(){t.$emit("ws:open")}),this.rws.addEventListener("message",function(e){try{var n=JSON.parse(e.data);t.$emit("ws:message",n)}catch(a){}})}}},e16e:function(t,e,n){},e351:function(t,e,n){"use strict";var a=n("e16e"),i=n.n(a);i.a},eed0:function(t,e,n){},fa23:function(t,e,n){"use strict";var a=n("eed0"),i=n.n(a);i.a}});
//# sourceMappingURL=client.5d9430c6.js.map